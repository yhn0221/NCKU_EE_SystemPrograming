# RegisterValueSorter

本程式為一個 SIC 組合語言撰寫的範例，用於讀取暫存器 A（24-bit）內的值，並將其拆解成 6 個 4-bit 的數字（nibble），再進行由小到大的排序，最後將排序後的結果重新組合成 24-bit，並以十六進位形式輸出。

## 目錄
1. [程式邏輯說明](#程式邏輯說明)  
2. [資料結構](#資料結構)  
3. [程式流程概述](#程式流程概述)  
4. [執行結果範例](#執行結果範例)  
5. [使用方式](#使用方式)  

---

## 程式邏輯說明

1. **讀取 24-bit 暫存器內容**  
   以 `LDA BUF` 方式將該值存入暫存器 A（該值於執行前已經存入暫存器 A，並且用 `STA BUF` 方式存到記憶體位置 `BUF`，供往後使用），並透過多次除法(`DIV`)與 `AND F`，將 24-bit 依序切割出 6 組 4-bit (一組 nibble)。

2. **儲存拆解後的 nibble**  
   每個 nibble 透過索引計算的方式，存放到記憶體陣列 `NUM` 中。  
   - `NUM[0]` ~ `NUM[5]` 對應暫存器 A 的 6 個 4-bit。

3. **氣泡排序 (Bubble Sort)**  
   針對 `NUM[0]` ~ `NUM[5]` 進行兩層迴圈的氣泡排序，由小到大。  
   - 內層迴圈在相鄰兩個元素比對時若發現前者較大，則交換兩者。

4. **重組 24-bit**  
   將排序完成後的 6 個 nibble，依照由左(高位)到右(低位)順序，重新組合成一個 24-bit，並存回 `BUF`。

5. **轉換並輸出**  
   透過一連串除法運算搭配 ASCII 偏移量(`BINASC = 48`)、十六進位對應 (A~F) 常數，將重組後的值 (在 `BUF`) 轉成十六進位字串存入 `BUFFER`，最後使用裝置 `OUTDIV` 進行輸出。

---

## 資料結構

- **`BUF`**  
  - 暫存空間 (RESW 1)，用來存放原始 24-bit 或排序後的新 24-bit。
- **`NUM`**  
  - 大小為 6 的資料區 (RESB 18，考量到在 SIC 中以 byte 為單位配置，且每個 4-bit 放在 1 byte 內)，用來存放分離後的 6 個 nibble。
- **`OUTC, INC`**  
  - 皆為迴圈計數用的變數 (RESW 1)，透過這兩個值做外圈與內圈的氣泡排序控管。
- **`TEMP`**  
  - 暫存變數 (RESW 1)，用於交換時暫存某個 nibble。
- **`BUFFER`**  
  - 用來存放轉為 ASCII 後的輸出字串 (RESB 6)。  
- **`LENNUM`**  
  - 輸出字串長度，避免多印或少印。  
- **`SHRDG*`**  
  - 存放 16^n 或與移位相關的常數 (例如 16^4 = 4096、16^1 = 16) 等，用以透過 `DIV` 或 `MUL` 來完成左/右移位效果。
- **`ACH`, `BCH`, `CCH`, ...**  
  - 轉換 10 ~ 15 的餘數值為對應字符 'A' ~ 'F'。

---

## 程式流程概述

1. **初始化 & 拆解暫存器值**  
   - 先將 `BUF` 的內容 (即暫存器 A 的 24-bit) 依次用 `DIV` 和 `AND F` 分割到 `NUM[0] ~ NUM[5]`。

2. **Bubble Sort**  
   - 外層迴圈：0 ~ 5 次  
   - 內層迴圈：從當前外層迴圈位置開始，對相鄰兩數比大小，如果後者 < 前者就互換。  

3. **重組結果**  
   - 將排序後的 `NUM[0] ~ NUM[5]` 以 `MUL` 和 `ADD` 方式逐一組合成 24-bit 並存回 `BUF`。  

4. **十六進位輸出**  
   - 針對最終 `BUF` 內容，每次取 4-bit，判斷是 0 ~ 9 或 A ~ F 的哪個範圍，轉成對應的 ASCII，存入 `BUFFER`。  
   - 最後透過 `TD`/`WD` 等方式將 `BUFFER` 內容輸出。  

5. **結束**  
   - `RSUB` 離開。

---

## 執行結果範例

假設暫存器 A 的值（24-bit）為 **`0x1A2B3C`**，對應的 6 個 nibble 為：
```
1, A, 2, B, 3, C
```
經由本程式排序後變成由小到大的順序：
```
1, 2, 3, A, B, C
```
重組後為 **`0x123ABC`**。最後輸出可見：
```
123ABC
```
> ※實際執行時，輸出取決於模擬器手動設定的的原始數值。  

---

## 使用方式

1. **在 SIC 模擬器中組譯、載入與執行**  
   - 將上述程式（`code`）放入 SIC 組譯器進行組譯。
   - 將組譯完的目的碼載入 SIC 模擬器


2. **調整暫存器 A 的初始值**  
   - 於 SIC 模擬器載入後調整暫存器 A 的值，共6位的十六進位值，如 **`0x123ABC`**。

3. **查看輸出**  
   - 透過模擬器的輸出裝置，可查看最終轉換後的十六進位字符結果。
